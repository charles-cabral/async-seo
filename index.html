<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Creme Dental Branqueador FreshSmile</title>
  <meta name="description" content="Compre Creme Dental Branqueador FreshSmile com menta refrescante, ação antitártaro e embalagem econômica de 90g. Envio para todo o Brasil.">
  <meta name="robots" content="index, follow">
  <link rel="canonical" href="https://www.exemplo.com/produtos/creme-dental-freshsmile">

  <!-- Dados Estruturados JSON-LD -->
  <script id="structured-data" type="application/ld+json">
  {
    "@context": "https://schema.org/",
    "@type": "Product",
    "name": "Creme Dental Branqueador FreshSmile",
    "image": "https://placehold.co/600x400?text=Creme+Dental",
    "description": "Creme Dental Branqueador com sabor de menta, ação antitártaro e embalagem econômica de 90g.",
    "sku": "FRESH-90G",
    "mpn": "123456789",
    "brand": {
      "@type": "Brand",
      "name": "FreshSmile"
    },
    "offers": {
      "@type": "Offer",
      "url": "https://www.exemplo.com/produtos/creme-dental-freshsmile",
      "priceCurrency": "BRL",
      "price": "9.90",
      "priceValidUntil": "2025-12-31",
      "itemCondition": "https://schema.org/NewCondition",
      "availability": "https://schema.org/InStock"
    },
    "aggregateRating": {
      "@type": "AggregateRating",
      "ratingValue": "4.7",
      "reviewCount": "187"
    }
  }
  </script>

  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0 auto;
      max-width: 1200px;
    }
    img {
      width: 100%;
      max-width: 600px;
      border-radius: 8px;
    }
    pre {
      background: #f4f4f4;
      padding: 15px;
      overflow-x: auto;
      border-radius: 6px;
      white-space: pre-wrap;
      word-wrap: break-word;
    }

    main {
        display: flex;
        gap: 2rem;
        flex-direction: row;
        align-items: flex-start;
    }

  </style>
</head>
<body>

    <main>
        <section>
            <h1>Creme Dental Branqueador FreshSmile</h1>
            <img src="https://placehold.co/600x400?text=Creme+Dental" alt="Creme Dental Branqueador FreshSmile">
          
            <p><strong>Preço:</strong> R$ 9,90</p>
            <p><strong>Marca:</strong> FreshSmile</p>
            <p><strong>SKU:</strong> FRESH-90G</p>
            <p><strong>Descrição:</strong> Creme Dental Branqueador com sabor de menta, ação antitártaro e embalagem econômica de 90g. Ideal para um hálito fresco e dentes mais brancos.</p>
            <p><strong>Condição:</strong> Novo</p>
            <p><strong>Disponibilidade:</strong> Em estoque</p>
            <p><strong>Avaliação média:</strong> 4.7/5 (com 187 avaliações)</p>
        </section>

        <section>
            <h2>Dados Estruturados JSON-LD</h2>
            <pre id="jsonld-display"></pre>
        </section>
    </main>

  <script>
    // Pega o conteúdo do script JSON-LD e exibe no <pre>
    const jsonLd = document.getElementById('structured-data').textContent;
    document.getElementById('jsonld-display').textContent = jsonLd;
  </script>

  <script>
    document.addEventListener('DOMContentLoaded', function() {

        console.log('Iniciando atualização do JSON-LD...');

        setTimeout(function() {
            const mockReviews = [
                {
                author: "Engler",
                rating: "5",
                comment: "Produto excelente, recomendo muito! Qualidade top.",
                date: "2024-07-04"
                },
                {
                author: "Teló",
                rating: "4",
                comment: "Muito bom, chegou rápido e bem embalado.",
                date: "2024-07-03"
                },
                {
                author: "Charles",
                rating: "5",
                comment: "Superou minhas expectativas, vou comprar novamente.",
                date: "2024-07-02"
                }
            ];

            const schemaScripts = document.querySelectorAll('script[type="application/ld+json"]');
            console.log('Tags JSON-LD encontradas:', schemaScripts.length);

            if (schemaScripts.length > 0) {
                const lastSchemaScript = schemaScripts[schemaScripts.length - 1];
                console.log('Tag JSON-LD selecionada (última):', lastSchemaScript);

                try {
                const schema = JSON.parse(lastSchemaScript.innerHTML);
                console.log('Reviews originais:', schema.review);

                schema.review = mockReviews.map(review => ({
                    "@type": "Review",
                    "reviewRating": {
                    "@type": "Rating",
                    "ratingValue": review.rating
                    },
                    "author": {
                    "@type": "Person",
                    "name": review.author
                    },
                    "datePublished": review.date,
                    "reviewBody": review.comment
                }));

                const avgRating = mockReviews.reduce((sum, r) => sum + parseInt(r.rating), 0) / mockReviews.length;
                schema.aggregateRating = {
                    "@type": "AggregateRating",
                    "ratingValue": avgRating.toFixed(1),
                    "ratingCount": mockReviews.length.toString()
                };

                const newJsonLD = JSON.stringify(schema, null, 2);
                lastSchemaScript.innerHTML = newJsonLD;

                console.log('Novo JSON-LD atualizado:');
                console.log('==========================================');
                console.log(newJsonLD);
                console.log('==========================================');

                // ✅ Atualiza o conteúdo do <pre> com o novo JSON
                document.getElementById('jsonld-display').textContent = newJsonLD;

                } catch (error) {
                console.error('Erro ao processar schema:', error);
                console.error('Conteúdo que causou erro:', lastSchemaScript.innerHTML);
                }
            } else {
                console.warn('⚠️ Nenhuma tag JSON-LD encontrada na página!');
            }
        }, 2000);
    });

  </script>

</body>
</html>
